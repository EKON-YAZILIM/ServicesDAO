@using DAO_WebPortal.Resources
@{
    Layout = "../Shared/_MainLayout.cshtml";

}

<script src="../Home/lib/ckeditor/ckeditor.js"></script>

<!--Row-->
<div class="row">
    <div class="col-md-12">
        <div class="form-group mb-4">
            <label class="mb-2" for="title"><b><i class="fas fa-heading"></i> Title</b></label>
            <input type="text" class="form-control" id="title" placeholder="Title of the post">
        </div> 
        <div class="form-group">
            <label class="mb-2" for="description"><b><i class="fas fa-file mx-1"></i> Description</b></label>
            <textarea type="text" id="description" name="description"  placeholder="Description of the vote" rows="10"></textarea>
        </div>
        <div class="d-flex justify-content-end my-3">
            <button type="submit" class="btn btn-primary" onclick="NewSimpleVotePost();">Start Voting</button>
        </div>
    </div>
</div>

@section Scripts{

    <script>
    $(document).ready(function () {
        if (document.body.classList.contains('dark-theme')) {
            CKEDITOR.replace('description', {
                skin: 'moono-dark'
            });
        }
        else {
            CKEDITOR.replace('description', {
                skin: 'moono-lisa'
            });
        }
    });

    //Add new simple vote function
    function NewSimpleVotePost() {

        $.confirm({
            title: 'Confirmation',
            content: '<p>Are you sure you want to start simple vote process ?</p>',
            columnClass: 'col-md-8 col-md-offset-2',
            buttons: {
                cancel: {
                    text: 'Cancel'
                },
                confirm: {
                    text: 'Continue',
                    btnClass: 'btn btn-primary',
                    action: function () {

                        //Create job model
                        var title = $('#title').val()
                        var description = CKEDITOR.instances["description"].getData();
                        //Ajax post action
                        $.ajax({
                            type: "POST",
                            url: "../Home/New_SimpleVote_Post",
                            data: { "title": title, "description": description },
                            success: function (result) {
                                if (result.success) {
                                    window.location.href = "../Votings";
                                }
                                else {
                                    toastr.warning(result.message);
                                }
                            },
                                failure: function (response) {
                                    toastr.warning("@Lang.ConnectionError");
                            },
                            error: function (response) {
                                    toastr.error("@Lang.UnexpectedError");
                            }
                        });


                    }

                }
            }
        });


    }
    </script>

}